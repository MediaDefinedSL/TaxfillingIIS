@inject Microsoft.Extensions.Configuration.IConfiguration Configuration
@using System.Security.Claims
@using Microsoft.AspNetCore.Html
@model List<TaxFiling.Web.Models.SelfOnlineInvestmentIncomeDetailViewModel>

<link href="~/assets/css/tree-container-css.css?v=3" rel="stylesheet">

<main class="main-content">

    <div class=" mt-4">
        <div class="card card-body">


            <form method="post">

                <div class=" mt-4 ">

                    <input type="hidden" id="hiddenInvestmentIncomeId" name="hiddenInvestmentIncomeId" />
                    <div class="custom-tabs">
                        <ul class="nav nav-tabs col-md-12" id="myTab" role="tablist">
                            <li class="nav-item col-md-2" role="presentation">
                                <button class="nav-link savings active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true" data-target="bank-section" >Savings</button>
                            </li>
                            <li class="nav-item col-md-2" role="presentation">
                                <button class="nav-link fixed-deposit" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false" tabindex="-1">Fixed Deposit</button>
                            </li>
                            <li class="nav-item col-md-2" role="presentation">
                                <button class="nav-link divident" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false" tabindex="-1">Divident</button>
                            </li>
                            <li class="nav-item col-md-2" role="presentation">
                                <button class="nav-link rent" id="rent-tab" data-bs-toggle="tab" data-bs-target="#rent" type="button" role="tab" aria-controls="rent" aria-selected="false" tabindex="-1"> Rent</button>
                            </li>

                            <li class="nav-item col-md-2" role="presentation">
                                <button class="nav-link other" id="otherincome-tab" data-bs-toggle="tab" data-bs-target="#otherincome" type="button" role="tab" aria-controls="otherincome" aria-selected="false" tabindex="-1"> Other Income</button>
                            </li>
                        </ul>
                        <div class="tab-content" id="myTabContent">
                            <div aria-labelledby="home-tab" role="tabpanel" id="home" class="tab-pane insvesment fade fade-in active show">
                               <br />
                                <h3 class="mb-3" >
                                    <i class="bi bi-piggy-bank"></i> &nbsp; Interest Income from Savings Accounts
                                </h3>
                                <hr>
                                <br />
                                <div class="row g-3">

                                    <!-- Activity Code -->
                                    <div class="col-md-6">
                                        <label class="form-label">Activity Code</label>
                                        <input type="text" id="txtSActivityCode" class="form-control" />
                                    </div>

                                    <!-- Type of Investment -->
                                    <div class="col-md-6">
                                        <label class="form-label">Type of Investment</label>
                                        <select class="form-select" id="ddlSTypeInvestment" name="ddlSTypeInvestment">
                                            <option value="">-- Select Activity Code --</option>
                                            <option value="121">121 - Interest Income – Local</option>
                                            <option value="122">122 - Interest Income – Foreign</option>
                                        </select>
                                       
                                    </div>
                                </div>
                                <hr>
                                <div class="row g-3">
                                    <!-- Bank Name -->
                                    <div class="col-md-6">
                                        <label class="form-label">Bank Name</label>
                                        <input type="text" id="bankInput" class="form-select" placeholder="Type Bank Name" autocomplete="off" />
                                        <div id="bankDropdown" class="dropdown"></div>
                                    </div>

                                    <!-- Bank Branch -->
                                    <div class="col-md-6">
                                        <label class="form-label">Bank Branch</label>
                                        <input type="text" id="branchInput" class="form-select" placeholder="Choose bank first" autocomplete="off" disabled />
                                        <div id="branchDropdown" class="dropdown"></div>
                                    </div>

                                    <!-- Account No -->
                                    <div class="col-md-6">
                                        <label class="form-label">Account No.</label>
                                        <input type="text" class="form-control" id="txtSAccountNo" name="txtSAccountNo">
                                    </div>

                                    <!-- WHT Certificate No -->
                                    <div class="col-md-6">
                                        <label class="form-label">WHT Certificate No.</label>
                                        <input type="text" class="form-control" id="txtSWHTCertificateNo" name="txtSWHTCertificateNo">
                                    </div>

                                    <!-- Amount Invested -->
                                    <div class="col-md-6">
                                        <label class="form-label">Amount Invested (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtSAmountInvested" name="txtSAmountInvested">
                                    </div>

                                    <!-- Interest Income -->
                                    <div class="col-md-6">
                                        <label class="form-label">Interest Income (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtSInterest" name="txtSInterest">
                                    </div>

                                    <!-- WHT Deducted -->
                                    <div class="col-md-6">
                                        <label class="form-label">WHT Deducted Amount (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtSWHTDeducted" name="txtSWHTDeducted">
                                    </div>

                                    <!-- Foreign Tax Credit -->
                                    <div class="col-md-6">
                                        <label class="form-label">Foreign Tax Credit (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtSForeignTaxCredit" name="txtSForeignTaxCredit">
                                    </div>

                                    <!-- Opening Balance -->
                                    <div class="col-md-6">
                                        <label class="form-label">Opening Balance (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtSOpeningBalance" name="txtSOpeningBalance">
                                    </div>

                                    <!-- Closing Balance -->
                                    <div class="col-md-6">
                                        <label class="form-label">Closing Balance (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtSBalance" name="txtSBalance">
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-md-6">
                                    </div>
                                    <div class="col-md-6">
                                        <div class=" align-items-right" style="text-align: right;">
                                            <button type="button" class="btn btn-primary mt-3" id="btnDetailsInvestmentClear">Clear</button>
                                            <button type="button" class="btn btn-primary mt-3" id="btnDetailsInvestmentSavings">Submit</button>
                                        </div>
                                    </div>
                                </div>

                                <hr class="my-4">

                                <div class="table-responsive" id="SavingsGrid">
                                    <table class="table table-bordered table-striped mt-2">
                                        <thead class="table-light">
                                            <tr>
                                                <th>No</th>
                                               <th>Type Investment</th>
                                                <th>Bank</th>
                                                <th>Branch</th>
                                                <th>Account No</th>
                                                <th>Interest Income</th>
                                                <th>WHT Deducted Amount</th>
                                                <th>Action</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.Any(d => d.Category == "Savings"))
                                            {
                                                var index = 0;
                                                foreach (var savingsIncome in Model.Where(d => d.Category == "Savings"))
                                                {
                                                    <tr>
                                                        <td>@(++index)</td>
                                                       <td>@savingsIncome.TypeOfInvestment</td>
                                                        <td>@savingsIncome.BankName</td>
                                                        <td>@savingsIncome.BankBranch</td>
                                                        <td>@savingsIncome.AccountNo</td>
                                                        <td>@savingsIncome.IncomeAmount</td>
                                                        <td>@savingsIncome.WHTDeducted</td>
                                                        <td>
                                                            <button class="btn btn-primary btn-sm savingsDetails-editbtn" type="button"
                                                                    data-id="@savingsIncome.InvestmentIncomeDetailId"
                                                                    data-category="Savings"
                                                                    data-activitycode="@savingsIncome.ActivityCode"
                                                                    data-typeofinvestment="@savingsIncome.TypeOfInvestment"
                                                                    data-bankname="@savingsIncome.BankName"
                                                                    data-bankbranch="@savingsIncome.BankBranch"
                                                                    data-accountno="@savingsIncome.AccountNo"
                                                                    data-whtcertificateno="@savingsIncome.WHTCertificateNo"
                                                                    data-whtdeducted="@savingsIncome.WHTDeducted"
                                                                    data-openingbalance="@savingsIncome.OpeningBalance"
                                                                    data-closingbalance="@savingsIncome.ClosingBalance"
                                                                    data-incomeamount="@savingsIncome.IncomeAmount"
                                                                    data-foreigntaxcredit="@savingsIncome.ForeignTaxCredit"
                                                                   
                                                                    data-amountinvested="@savingsIncome.AmountInvested">
                                                                Edit
                                                            </button>
                                                            <button class="btn btn-danger btn-sm investmentDetails-deletebtn" type="button"
                                                                    data-id="@savingsIncome.InvestmentIncomeDetailId"
                                                                    data-name="Savings">
                                                                Delete
                                                            </button>
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            else
                                            {
                                                <tr>
                                                    <td colspan="8" class="text-center">No Savings Income found.</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                          @*  ----- Fixed Deposit ------ *@

                            <div class="tab-pane insvesment fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                                <br />
                                <h3 class="mb-3"> <i class="bi bi-bank"></i> &nbsp; Interest Income from Fixed Deposit Accounts</h3>
                                <hr>
                                <div class="row g-3">

                                    <!-- Activity Code -->
                                    <div class="col-md-6">
                                        <label class="form-label">Activity Code</label>
                                        <input type="text" id="txtFDActivityCode" class="form-control" />
                                    </div>

                                    <!-- Type of Investment -->
                                    <div class="col-md-6">
                                        <label class="form-label">Type of Investment</label>
                                        <select class="form-select" id="ddlFDTypeInvestment" name="ddlFDTypeInvestment">
                                            <option value="">-- Select Activity Code --</option>
                                            <option value="121">121 - Interest Income – Local</option>
                                            <option value="122">122 - Interest Income – Foreign</option>
                                        </select>

                                    </div>
                                </div>
                                <hr>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Bank Name</label>
                                        <input type="text" id="FDbankInput" class="form-select" placeholder="Type Bank Name" autocomplete="off" />
                                        <div id="FDbankDropdown" class="dropdown"></div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Bank Branch</label>
                                        <input type="text" id="FDbranchInput" class="form-select" placeholder="Choose bank first" autocomplete="off" disabled />
                                        <div id="FDbranchDropdown" class="dropdown"></div>
                                    </div>
                                    <!-- Account No -->
                                    <div class="col-md-6">
                                        <label class="form-label">Account No.</label>
                                        <input type="text" class="form-control" id="txtFDAccountNo" name="txtFDAccountNo">
                                    </div>

                                    <!-- WHT Certificate No -->
                                    <div class="col-md-6">
                                        <label class="form-label">WHT Certificate No.</label>
                                        <input type="text" class="form-control" id="txtFDWHTCertificateNo" name="txtFDWHTCertificateNo">
                                    </div>

                                    <!-- Amount Invested -->
                                    <div class="col-md-6">
                                        <label class="form-label">Amount Invested (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtFDAmountInvested" name="txtFDAmountInvested">
                                    </div>

                                    <!-- Interest Income -->
                                    <div class="col-md-6">
                                        <label class="form-label">Interest Income (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtFDInterest" name="txtFDInterest">
                                    </div>

                                    <!-- WHT Deducted -->
                                    <div class="col-md-6">
                                        <label class="form-label">WHT Deducted Amount (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtFDWHTDeducted" name="txtFDWHTDeducted">
                                    </div>

                                    <!-- Foreign Tax Credit -->
                                    <div class="col-md-6">
                                        <label class="form-label">Foreign Tax Credit (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtFDForeignTaxCredit" name="txtFDForeignTaxCredit">
                                    </div>

                                    <!-- Opening Balance -->
                                    <div class="col-md-6">
                                        <label class="form-label">Opening Balance (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtFDOpeningBalance" name="txtFDOpeningBalance">
                                    </div>

                                    <!-- Closing Balance -->
                                    <div class="col-md-6">
                                        <label class="form-label">Closing Balance (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtFDBalance" name="txtFDBalance">
                                    </div>
                                </div>
                                
                                <br />
                                <div class="row">
                                    <div class="col-md-6">
                                    </div>
                                    <div class="col-md-6">
                                        <div class=" align-items-right" style="text-align: right;">
                                            <button type="button" class="btn btn-primary mt-3" id="btnDetailsInvestmentFDClear">Clear</button>
                                            <button type="button" class="btn btn-primary mt-3" id="btnDetailsInvestmentFD" >Submit</button>
                                        </div>
                                    </div>
                                </div>

                                <hr class="my-4">

                                <div class="table-responsive" id="FDGrid">
                                    <table class="table table-bordered table-striped mt-2">
                                        <thead class="table-light">
                                            <tr>
                                                <th>No</th>
                                                <th>Type Investment</th>
                                                <th>Bank</th>
                                                <th>Branch</th>
                                                <th>Account No</th>
                                                <th>Interest Income</th>
                                                <th>WHT Deducted Amount</th>
                                                <th>Action</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.Any(d => d.Category == "FixedDeposit"))
                                            {
                                                var index = 0;
                                                foreach (var fdIncome in Model.Where(d => d.Category == "FixedDeposit"))
                                                {
                                                    <tr>
                                                        <td>@(++index)</td>
                                                        <td>@fdIncome.TypeOfInvestment</td>
                                                        <td>@fdIncome.BankName</td>
                                                        <td>@fdIncome.BankBranch</td>
                                                        <td>@fdIncome.AccountNo</td>
                                                        <td>@fdIncome.IncomeAmount</td>
                                                        <td>@fdIncome.WHTDeducted</td>
                                                        <td>
                                                            <button class="btn btn-primary btn-sm fixedDepositDetails-editbtn" type="button"
                                                                    data-id="@fdIncome.InvestmentIncomeDetailId"
                                                                    data-category="Savings"
                                                                    data-activitycode="@fdIncome.ActivityCode"
                                                                    data-typeofinvestment="@fdIncome.TypeOfInvestment"
                                                                    data-bankname="@fdIncome.BankName"
                                                                    data-bankbranch="@fdIncome.BankBranch"
                                                                    data-accountno="@fdIncome.AccountNo"
                                                                    data-whtcertificateno="@fdIncome.WHTCertificateNo"
                                                                    data-whtdeducted="@fdIncome.WHTDeducted"
                                                                    data-openingbalance="@fdIncome.OpeningBalance"
                                                                    data-closingbalance="@fdIncome.ClosingBalance"
                                                                    data-incomeamount="@fdIncome.IncomeAmount"
                                                                    data-foreigntaxcredit="@fdIncome.ForeignTaxCredit"
                                                                    data-amountinvested="@fdIncome.AmountInvested">
                                                                Edit
                                                            </button>
                                                            <button class="btn btn-danger btn-sm investmentDetails-deletebtn" type="button"
                                                                    data-id="@fdIncome.InvestmentIncomeDetailId"
                                                                    data-name="FixedDeposit">
                                                                Delete
                                                            </button>
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            else
                                            {
                                                <tr>
                                                    <td colspan="8" class="text-center">No FixedDeposit Income found.</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            @*  ----- Divident ------ *@
                            <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                                <br />
                                <h3 class="mb-3"> <i class="bi bi-pie-chart-fill"></i> &nbsp; Dividend Income</h3>
                                <hr>
                                <div class="row g-3">

                                    <!-- Activity Code -->
                                    <div class="col-md-6">
                                        <label class="form-label">Activity Code</label>
                                        <input type="text" id="txtDActivityCode" class="form-control" />
                                    </div>

                                    <!-- Type of Investment -->
                                    <div class="col-md-6">
                                        <label class="form-label">Type of Investment</label>
                                        <select class="form-select" id="ddlDTypeInvestment" name="ddlDTypeInvestment">
                                            <option value="">-- Select Activity Code --</option>
                                            <option value="111">111 - Dividend Income – Local</option>
                                            <option value="112">112 - Dividend Income – Foreign</option>
                                        </select>

                                    </div>
                                </div>
                                <hr>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Amount Invested (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtDAmountInvested" name="txtDAmountInvested">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Dividend Income (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtDDividendIncome" name="txtDDividendIncome">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Name of company/institution</label>
                                        <input class="form-control" id="txtDNameCompanyInstitution" name="txtDNameCompanyInstitution">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">No. of Shares/Stocks</label>
                                        <input type="number" class="form-control" id="txtDSharesStocks" name="txtDSharesStocks">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Date of Acquisition</label>
                                        <input type="date" class="form-control" id="txtDAcquisition" name="txtDAcquisition">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Cost of acquisition/market value if not acquired (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtDCostAcquisitionMarket" name="txtDCostAcquisitionMarket">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">WHT Deducted Amount (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtDWHTDeducted" name="txtDWHTDeducted">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Foreign Tax Credit (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtDForeignTaxCredit" name="txtDForeignTaxCredit">
                                    </div>
                                   
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-md-6">
                                    </div>
                                    <div class="col-md-6">
                                        <div class=" align-items-right" style="text-align: right;">
                                            <button type="submit" class="btn btn-primary mt-3" id="btnDetailsInvestmentDivident">Submit</button>
                                        </div>
                                    </div>

                                </div>
                                <hr class="my-4">
                                <div class="table-responsive" id="DividentGrid">
                                    <table class="table table-bordered table-striped mt-2">
                                        <thead class="table-light">
                                            <tr>
                                                <th>No</th>
                                                <th>Type Investment</th>
                                                <th>Amount Invested </th>
                                                <th>Dividend Income </th>
                                                <th>Company/Institution</th>
                                                <th>Shares/Stocks</th>
                                                <th>Cost Acquisition</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.Any(d => d.Category == "Dividend"))
                                            {
                                                var index = 0;
                                                foreach (var dividendIncome in Model.Where(d => d.Category == "Dividend"))
                                                {
                                                    <tr>
                                                        <td>@(++index)</td>
                                                        <td>@dividendIncome.TypeOfInvestment</td>
                                                        <td>@dividendIncome.AmountInvested</td>
                                                        <td>@dividendIncome.NetDividendIncome</td>
                                                        <td>@dividendIncome.CompanyInstitution</td>
                                                        <td>@dividendIncome.SharesStocks</td>
                                                        <td>@dividendIncome.CostAcquisition</td>
                                                        <td>
                                                            <button class="btn btn-primary btn-sm dividend-editbtn" type="button"
                                                                    data-id="@dividendIncome.InvestmentIncomeDetailId"
                                                                    data-category="Dividend"
                                                                    data-activitycode="@dividendIncome.ActivityCode"
                                                                    data-typeofinvestment="@dividendIncome.TypeOfInvestment"
                                                                    data-amountinvested="@dividendIncome.AmountInvested"
                                                                    data-company="@dividendIncome.CompanyInstitution"
                                                                    data-shares="@dividendIncome.SharesStocks"
                                                                    data-acquisition="@dividendIncome.AcquisitionDate?.ToString("yyyy-MM-dd")"
                                                                    data-cost="@dividendIncome.CostAcquisition"
                                                                    data-netdividend="@dividendIncome.NetDividendIncome"
                                                                    data-netwhtdeducted="@dividendIncome.WHTDeducted"
                                                                    data-netforeigntaxcredit="@dividendIncome.ForeignTaxCredit">
                                                                Edit
                                                            </button>
                                                            <button class="btn btn-danger btn-sm investmentDetails-deletebtn" type="button"
                                                                    data-id="@dividendIncome.InvestmentIncomeDetailId"
                                                                    data-name="Dividend">
                                                                Delete
                                                            </button>
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            else
                                            {
                                                <tr>
                                                    <td colspan="8" class="text-center">No Dividend Income found.</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            @*  ----- Rent ------ *@
                            <div class="tab-pane fade" id="rent" role="tabpanel" aria-labelledby="rent-tab">
                                <br />
                                <h3 class="mb-3"> <i class="bi bi-house-door"></i> &nbsp;  Rent Income</h3>
                                <hr>
                                <div class="row g-3">
                                    <!-- Activity Code -->
                                    <div class="col-md-6">
                                        <label class="form-label">Activity Code</label>
                                        <input type="text" id="txtRActivityCode" class="form-control" />
                                    </div>

                                    <!-- Type of Investment -->
                                    <div class="col-md-6">
                                        <label class="form-label">Type of Investment</label>
                                        <select class="form-select" id="ddlRTypeInvestment" name="ddlRTypeInvestment">
                                            <option value="">-- Select Activity Code --</option>
                                            <option value="311">311 - Rent Income – Local</option>
                                            <option value="312">312 - Rent Income – Foreign</option>
                                        </select>

                                    </div>
                                </div>
                                <hr>
                                <div class="row g-3">
                                    
                                    <div class="col-md-6">
                                        <label class="form-label">Situation of property</label>
                                        <input type="text" class="form-control" id="txtRProperty" name="txtRProperty">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Addess</label>
                                        <input type="text" class="form-control" id="txtRAddess" name="txtRAddess">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Total Rent Income </label>
                                        <input type="text" class="form-control numeric-input" id="txtRTotalRentIncome" name="txtRTotalRentIncome">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Rates and local authority</label>
                                        <input type="text" class="form-control" id="txtRRatesLocalAuthority" name="txtRRatesLocalAuthority">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Date of Acquisition</label>
                                        <input type="date" class="form-control" id="txtRAcquisitionDate" name="txtRAcquisitionDate">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Cost (Rs.) / Gift/ Inhreted</label>
                                        <input type="text" class="form-control numeric-input" id="txtRCostGiftInhreted" name="txtRCostGiftInhreted">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Market Value (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtRMarketValue" name="txtRMarketValue">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Foreign Tax Credit </label>
                                        <input type="text" class="form-control numeric-input" id="txtForeignTaxCredit" name="txtForeignTaxCredit">
                                    </div>
                                    
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                    </div>
                                    <div class="col-md-6">
                                        <div class=" align-items-right" style="text-align: right;">
                                            <button type="button" class="btn btn-primary mt-3" id="btnDetailsInvestmentRent">Submit</button>
                                        </div>
                                    </div>
                                </div>

                                <hr class="my-4">
                                <div class="table-responsive" id="RentGrid">
                                    <table class="table table-bordered table-striped mt-2">
                                        <thead class="table-light">
                                            <tr>
                                                <th>No</th>
                                                <th>Type Investment</th>
                                                <th>Situation property Deed No</th>
                                                <th>Total Rent Income </th>
                                                <th>Cost Gift/ Inhreted</th>
                                                <th>Market value</th>
                                                <th>Action</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.Any(d => d.Category == "Rent"))
                                            {
                                                var index = 0;
                                                foreach (var rentIncome in Model.Where(d => d.Category == "Rent"))
                                                {
                                                    <tr>
                                                        <td>@(++index)</td>
                                                        <td>@rentIncome.TypeOfInvestment</td>
                                                        <td>@rentIncome.PropertySituation</td>
                                                        <td>@rentIncome.IncomeAmount</td>
                                                        <td>@rentIncome.GiftOrInheritedCost</td>
                                                        <td>@rentIncome.MarketValue</td>
                                                        
                                                        <td>
                                                            <button class="btn btn-primary btn-sm rent-editbtn" type="button"
                                                                    data-id="@rentIncome.InvestmentIncomeDetailId"
                                                                    data-category="Rent"
                                                                    data-activitycode="@rentIncome.ActivityCode"
                                                                    data-activity="@rentIncome.TypeOfInvestment"
                                                                    data-property="@rentIncome.PropertySituation"
                                                                    data-address="@rentIncome.PropertyAddress"
                                                                    data-income="@rentIncome.IncomeAmount"
                                                                    data-acquisition="@rentIncome.AcquisitionDate"
                                                                    data-rates="@rentIncome.RatesLocalAuthority"
                                                                    data-cost="@rentIncome.GiftOrInheritedCost"
                                                                    data-market="@rentIncome.MarketValue"
                                                                    data-foreigntax="@rentIncome.ForeignTaxCredit">
                                                                Edit
                                                            </button>
                                                            <button class="btn btn-danger btn-sm investmentDetails-deletebtn" type="button"
                                                                    data-id="@rentIncome.InvestmentIncomeDetailId"
                                                                    data-name="Rent">
                                                                Delete
                                                            </button>
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            else
                                            {
                                                <tr>
                                                    <td colspan="7" class="text-center">No Dividend Income found.</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>

                                <hr class="my-4">
                                <h5 class="mb-3"> <i class="fas fa-wallet me-2"></i> Reliefs for investment income</h5>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Relief for Rent Income (25%)</label>
                                        <input type="text" class="form-control" id="txtReliefRentIncome" name="txtReliefRentIncome">
                                    </div>
                                 </div>
                                 <br />
                            </div>

                            <div class="tab-pane fade" id="otherincome" role="tabpanel" aria-labelledby="otherincome-tab">
                                <h3 class="mb-3"> <i class="bi bi-cash-coin"></i> &nbsp; Other Income</h3>
                                <hr>
                                <br />
                                <div class="row g-3">

                                    <!-- Activity Code -->
                                    <div class="col-md-6">
                                        <label class="form-label">Activity Code</label>
                                        <input type="text" id="txtOActivityCode" class="form-control" />
                                    </div>
                                    <!-- Type of Investment -->
                                    <div class="col-md-6">
                                        <label class="form-label">Type of Investment</label>
                                        <select class="form-select" id="ddlOTypeInvestment" name="ddlOTypeInvestment">
                                            <option value="">-- Select Activity Code --</option>
                                            <option value="211">211 - GAIN FROM THE REALIZATION OF ASSETS - Local</option>
                                            <option value="212">212 - GAIN FROM THE REALIZATION OF ASSETS - Foreign</option>
                                            <option value="411">411 - WINNING FROM LOTTERIES, BETTING OR GAMBLING - Local</option>
                                            <option value="412">412 - WINNING FROM LOTTERIES, BETTING OR GAMBLING - Foreign</option>
                                            <option value="511">511 - ROYALTY INCOME - Local</option>
                                            <option value="512">512 - ROYALTY INCOME - Foreign</option>
                                            <option value="611">611 - ANNUITY INCOME - Local</option>
                                            <option value="612">612 - ANNUITY INCOME - Foreign</option>
                                            <option value="711">711 - NATURAL RESOURCE PAYMENT - Local</option>
                                            <option value="712">712 - NATURAL RESOURCE PAYMENT - Foreign</option>
                                            <option value="811">811 - DISCOUNT INCOME - Local</option>
                                            <option value="812">812 - DISCOUNT INCOME - Foreign</option>
                                            <option value="911">911 - OTHER INVESTMENT INCOME - Local</option>
                                            <option value="912">912 - OTHER INVESTMENT INCOME - Foreign</option>
                                        </select>
                                    </div>
                                </div>
                                <hr>
                                <div class="row g-3">

                                    <div class="col-md-6">
                                        <label class="form-label">Amount Invested (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtOAmountInvested" name="txtOAmountInvested">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Interest Income (Rs.)</label>
                                        <input type="text" class="form-control numeric-input" id="txtOInterestIncome" name="txtOInterestIncome">
                                    </div>
                                    
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                    </div>
                                    <div class="col-md-6">
                                        <div class=" align-items-right" style="text-align: right;">
                                            <button type="button" class="btn btn-primary mt-3" id="btnDetailsInvestmentOther">Submit</button>
                                        </div>
                                    </div>
                                </div>


                                <hr class="my-4">
                                <div class="table-responsive" id="OtherGrid">
                                    <table class="table table-bordered table-striped mt-2">
                                        <thead class="table-light">
                                            <tr>
                                                <th>No</th>
                                                <th>Type Investment</th>
                                                <th>Amount Invested</th>
                                                <th>Interest Income </th>
                                                <th>Action</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.Any(d => d.Category == "Other"))
                                            {
                                                var index = 0;
                                                foreach (var otherIncome in Model.Where(d => d.Category == "Other"))
                                                {
                                                    <tr>
                                                        <td>@(++index)</td>
                                                        <td>@otherIncome.TypeOfInvestment</td>
                                                        <td>@otherIncome.AmountInvested</td>
                                                        <td>@otherIncome.IncomeAmount</td>
                                                        

                                                        <td>
                                                            <button class="btn btn-primary btn-sm other-editbtn" type="button"
                                                                    data-id="@otherIncome.InvestmentIncomeDetailId"
                                                                    data-category="Other"
                                                                    data-activitycode="@otherIncome.ActivityCode"
                                                                    data-activity="@otherIncome.TypeOfInvestment"
                                                                    data-amount="@otherIncome.AmountInvested"
                                                                    data-income="@otherIncome.IncomeAmount">
                                                                Edit
                                                            </button>
                                                            <button class="btn btn-danger btn-sm investmentDetails-deletebtn" type="button"
                                                                    data-id="@otherIncome.InvestmentIncomeDetailId"
                                                                    data-name="Other">
                                                                Delete
                                                            </button>
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            else
                                            {
                                                <tr>
                                                    <td colspan="5" class="text-center">No Other income found.</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                    </div>
                    
                </div>

            </form>
            <br><br>
            <div class="d-lg-flex justify-content-between">
                <div class="col-lg-6 col-md-6 btn-prv">
                    <button class="btn btn-primary btn-lg" id="linkEmploymentDetailsContinue">
                        Back
                    </button>
                </div>
                <div class="col-lg-6 col-md-6 right next-btn" id="linkExemptAmountsContinue">
                    <button class="btn btn-primary btn-lg">
                        Continue
                    </button>
                </div>
            </div>
        </div>
        
    </div>

</main>

<script src="~/scripts/selfonline.investmentincome.js" asp-append-version="true"></script>

<script>

    //  // Load all branches once
    // $.getJSON("https://mail.taxfiling.lk/bank-branches", function (data) {
    //     allBranches = data.map(branch => ({
    //         id: branch.BranchCode,
    //         // text: branch.BranchName + " (" + branch.bankName + ")" // show both branch and bank
    //         text: branch.BranchName
    //     }));

    //     $('#dpdBankInstitution').select2({
    //         placeholder: "Select bank",
    //         minimumInputLength: 0, // allow opening full list without typing
    //         data: allBranches,
    //         matcher: function (params, data) {
    //             // If no search term, show all
    //             if ($.trim(params.term) === '') {
    //                 return data;
    //             }

    //             // Match text anywhere (contains match, not just startsWith)
    //             if (data.text.toLowerCase().startsWith(params.term.toLowerCase())) {
    //                 return data;
    //             }

    //             return null;
    //         },
    //         dropdownAutoWidth: true,
    //         width: 'resolve',
    //         allowClear: true
    //     });
    // });

    // $('#dpdBankInstitution').on('select2:open', function () {
    //     let searchBox = document.querySelector('.select2-container--open .select2-search__field');
    //     if (searchBox) {
    //         searchBox.setAttribute('placeholder', 'Filter your choice');
    //     }
    // });
</script>